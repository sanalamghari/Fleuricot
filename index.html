<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" href="./index.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Votre Cart</h1>
            <div class="shopping">
                <i class="fa-solid fa-cart-shopping"></i>
                <span class="qantity">0</span>
            </div>
        </header>
        <div class="list"></div>
    
    </div>
        <div class="cart">
            <h1>Carte</h1>
            <ul class="listCart"></ul>
            <div class="checkout">
            <div class="total">0</div>
            <div class="closeShopping">close</div>
       
        </div>
    </div>
    <button class="deman"><a href="./detail.html">details</a></button>
    <button class="deman"><a href="./valider.html">Demande</a></button>
    
    <script>
        
       let openshoppping =document.querySelector('.shopping') ;

       let closeshoping =document.querySelector('.closeShopping');

       let list =document.querySelector('.list');

       let listCart =document.querySelector('.listCart');

       let body =document.querySelector('body')

       let total =document.querySelector('.total');

       let quantity =document.querySelector('.qantity');

       openshoppping.addEventListener('click',()=>{

        body.classList.add('active');

       })
 
       closeshoping.addEventListener('click',()=>{

       body.classList.remove('active');

       })
       
       let prodiuts=[
        {
        id:1,
        name:'tricot noire  ',
        image:'./im1.png',
        price:250,
       },
       {
        id:2,
        name:'tricot blanch ',
        image:'./im2.jpg',
        price:300,
       },
       {
        id:3,
        name:'le roxe et le blanch',
        image:'./im3.jpg',
        price:250,
       },
       {
        id:4,
        name:' Fleur Stéréo ',
        image:'./im21.png',
        price:300,
       },
       {
        id:5,
        name:'Fleuri Cardigan ',
        image:'./im5.jpg',
        price:250,
       },
       {
        id:6,
        name:' Fleur Stéréo ',
        image:'./im6.jpg',
        price:240,
       },
       {
        id:7,
        name:'cleure ',
        image:'./im7.jpg',
        price:300,
       },
       {
        id:8,
        name:'Fleuri Cardigan',
        image:'./im8.jpg',
        price:250,
       },
       {
        id:9,
        name:'Fleuri Cardigan',
        image:'./im9.jpg',
        price:260,
       },
       {
        id:10,
        name:' Fleur Stéréo',
        image:'./im10.jpg',
        price:300,
       },
       {
        id:11,
        name:' Fleur Stéréo',
        image:'./im11.jpg',
        price:240,
       },
       {
        id:12,
        name:'Fleuri Cardigan ',
        image:'./im12.png',
        price:330,
       }
    ];
       
      let listCarts =[]; 

    

          prodiuts.forEach((value,key)=>{

            let newDiv = document.createElement('div');

            newDiv.classList.add('item')
            
            newDiv.innerHTML =
             `
             <img src="${value.image}" alt="">
              <div class="title">${value.name}</div>
              <div class="price">${value.price.toLocaleString()}dh</div>
              <button onclick="addToCart(${key})">Ajouter</button>
            
             `
            list.appendChild(newDiv)
          })
        
          function addToCart(key){

            let quantity =document.querySelector('.qantity');
             
            if(listCarts[key] == null){

                listCarts[key]=prodiuts[key];

                listCarts[key].quantity =1;

            }

            reloadCarts()

          }

           function reloadCarts(){

            let quantity =document.querySelector('.qantity');

             listCart.innerHTML='';

             let count = 0;

             let totalPrice =0;

             listCarts.forEach((value,key)=>{

                totalPrice = totalPrice + value.price;

                count = count + value.quantity;

                if(value != null){

                let newDiv = document.createElement('li');

                newDiv.innerHTML=

             `
             <div><img src="${value.image}" alt=""></div>
             <div>${value.name}</div>
             <div>${value.price.toLocaleString()}dh</div>
             
             <div>
             <button onclick="changeQuantity(${key},${value.quantity -1})">-</button>
             <div class="count">${value.quantity}</div>
             <button onclick="changeQuantity(${key},${value.quantity+1})">+</button>
             </div>

             `;
             listCart.appendChild(newDiv);

            }

            })

            total.innerText = totalPrice.toLocaleString();

            quantity.innerText = count;

           }

           function changeQuantity(key,quantity){

    

            if(quantity==0){

                delete listCarts[key];

            }else{
                
                listCarts[key].quantity = quantity;

                listCarts[key].price = quantity*prodiuts[key].price;

            }
            reloadCarts();
           }
       //https://sanalamghari.github.io/E-commerce-website/amazon.html
       //https://sanalamghari.github.io/marque-Fleuricot/acceuil.html
    
    </script>
    
</body>
</html>
       